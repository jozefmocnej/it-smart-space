@*@model IEnumerable<SmartSpaceWeb.Models.Sensor>*@

@{
    ViewBag.Title = "KitchenIndex";
    //Layout = "~/Views/Shared/_Layout.cshtml";
    string room2 = @ViewBag.room;
}
@*<meta http-equiv="refresh" content="5" />*@
<h2>@ViewBag.room Data</h2>

<p>
    <br/>
</p>
<div class="row">
    <div class="col-md-4">
@{switch (room2)
  {
      case "KITCHEN":
        <img src="~/Images/kitchen.jpg" alt="kitchen" style="width:380px;" />
          break;
      case "BATHROOM":
    <img src="~/Images/bathroom.jpg" alt="batchroom" style="width:380px;" />
          break;
      case "DOUBLE_BEDROOM":
    <img src="~/Images/doublebedroom.jpg" alt="doublebedroom" style="width:380px;" />
          break;
      default:
    <img src="~/Images/questionroom.png" alt="unknown" style="width:380px;" />
          break;
  }
  }
    </div>
    <div class="col-md-8">
        @*@Html.Partial("_SensorPartial", new List<SmartSpaceWeb.Models.Sensor>())*@
        <div id="divPartial"></div>
@*<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Type)
        </th>
        <th>
                    @Html.DisplayNameFor(model => model.Place)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Timestamp)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Status)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Counter)
        </th>
        <th></th>
    </tr>

    @{
        List<DateTime> time = new List<DateTime>();
        List<String> type = new List<string>();
        }
            @foreach (var item in Model)
            {
    if (type.Contains(item.Type))
    {
        if (time[type.IndexOf(item.Type)] < Convert.ToDateTime(item.Timestamp))
        { time[type.IndexOf(item.Type)] = Convert.ToDateTime(item.Timestamp); }
    }
    else
    {
        type.Add(item.Type);
        time.Add(Convert.ToDateTime(item.Timestamp));
    }
}
@foreach (var item in Model)
{
    if (time[type.IndexOf(item.Type)] == Convert.ToDateTime(item.Timestamp))
    { 
    <tr>
        <td>
                            @{switch (item.Type)
                            {
                                case "temperature":
                                <img src="~/Images/temperature.png" alt="temperature" style="width:50px;height:50px;" />
                                    break;
                                case "pir":
                                <img src="~/Images/pir.jpg" alt="pir" style="width:50px;height:50px;" />
                                    break;
                                case "humidity":
                                <img src="~/Images/humid.jpg" alt="humidity" style="width:50px;height:50px;" />
                                    break;
                                case "light":
                                <img src="~/Images/Lightbulb.jpg" alt="light" style="width:50px;height:50px;" />
                                    break;
                                case "gas_ethanole":
                                <img src="~/Images/flame.gif" alt="gas leak" style="width:50px;height:50px;" />
                                    break;
                                default:
                                <img src="~/Images/question.png" alt="unknown" style="width:50px;height:50px;" />
                                    break;
                            }
                            }
                        </td>
                        <td>
                            <br />
                            @Html.DisplayFor(modelItem => item.IdDevice)
        </td>
        <td>
                            <br/>
                            @Html.DisplayFor(modelItem => item.Place)
        </td>
        <td>
                            <br/>
            @Html.DisplayFor(modelItem => item.Timestamp)
        </td>
        <td>
                            <br />
            @Html.DisplayFor(modelItem => item.Status)
        </td>
        <td>
            <br />
            @Html.DisplayFor(modelItem => item.Counter)
        </td>
        <td>
                            <br />
                            @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
        </td>
    </tr>
}
}

</table>*@
        </div>
</div>
<script>
    var urlPartialVariable = '@Url.Action("_SensorPartial", "Sensor", new { room = room2 })';
</script>
<script src="~/Scripts/sensors.js"></script>